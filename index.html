<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Database Search</title>
<link rel="shortcut icon" href="dta.png" type="image/png">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://script.google.com https://*.googleapis.com https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:;">

<style>
:root{
  --bg:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:rgba(255,255,255,.12);
}

*{box-sizing:border-box}

body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#000;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  color:var(--text);
}

.container{
  width:100%;
  max-width:900px;
  padding:25px;
  display:flex;
  flex-direction:column;
  align-items:center;
}

h1{
  margin:8px 0 64px;
  font-size:36px;
  font-weight:800;
  color:#fff;
}

/* ===== Loader ===== */
.loading{
  width:60px;height:60px;position:relative;margin:25px auto
}
.d1,.d2{border:5px solid #6c757d;border-radius:50px}
.d1{
  width:55px;height:55px;position:absolute;
  border-left-color:transparent;
  animation:spin 1s linear infinite
}
.d2{
  width:40px;height:40px;margin:7.5px;
  border-top-color:transparent;
  border-right-color:transparent;
  animation:spin2 1.5s linear infinite
}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes spin2{to{transform:rotate(-360deg)}}

.loading-text{
  display:none;
  color:#94a3b8;
  font-size:13px;
  margin-top:8px;
}

/* ===== Search ===== */
.search-box{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
}

.search-wrapper{
  width:100%;
  max-width:540px;
  height:56px;
  border-radius:40px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,.06);
  position:relative;
  transition:.3s;
}
.search-wrapper:focus-within{
  transform:translateY(-2px);
  background:rgba(255,255,255,.12);
}


.search-wrapper input{
  width:100%;
  height:100%;
  border:none;
  outline:none;
  background:transparent;
  padding:0 50px 0 24px;
  font-size:16px;
  color:#fff;
}

.search-icon{
  position:absolute;
  right:24px;
  top:50%;
  transform:translateY(-50%);
  width:26px;height:26px;
}
.search-icon::before{
  content:"";
  width:16px;height:16px;
  border:3px solid #fff;
  border-radius:50%;
  position:absolute;
}
.search-icon::after{
  content:"";
  width:12px;height:3px;
  background:#fff;
  position:absolute;
  transform:rotate(45deg);
  right:-2px;bottom:2px;
  border-radius:2px;
}

/* ===== Results ===== */
.results-panel{
  width:100%;
  max-width:900px;
  margin-top:18px;
  padding:14px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.05);
  border-radius:14px;
  display:none;
}
.results-panel.show{display:block}

table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:12px;
  font-size:14px;
}
th{color:#a7f3d0}
tbody tr{
  border-bottom:1px solid var(--border);
}
tbody tr:hover{
  background:rgba(255,255,255,.06);
}

.badge{
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  background:rgba(34,197,94,.15);
  color:#22c55e;
}

.empty{
  display:none;
  text-align:center;
  color:var(--muted);
}

/* Disable text selection where needed */
.no-select{
  user-select:none;
  -webkit-user-select:none;
  -ms-user-select:none;
}

/* ===== Social Icons ===== */
.footer{
  margin-top:50px;
  display:flex;
  gap:20px;
}

.social-link{
  width:44px;height:44px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.1);
  transition:.3s;
}
.social-link:hover{
  transform:translateY(-3px);
  background:rgba(59,130,246,.2);
}

.social-link svg{
  width:22px;
  height:22px;
  fill:#e5e7eb;
  transition:.3s;
}
.social-link:hover svg{
  fill:#3b82f6;
  transform:scale(1.15);
}
</style>
</head>

<body>

<div class="container">
  <h1>DATABASE SEARCH</h1>

  <div class="search-box">
    <div class="search-wrapper">
      <input id="q" placeholder="Search..." onkeyup="autoSearch(event)">
      <div class="search-icon"></div>
    </div>


    <div id="loader" class="loading" style="display:none">
      <div class="d1"></div><div class="d2"></div>
    </div>
    <div id="loading-text" class="loading-text">Connecting to API...</div>

    <div id="results-panel" class="results-panel no-select">
      <table id="table">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Phone</th><th>Device</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="empty" class="empty">No results found</div>
    </div>
  </div>

  <div class="footer no-select">
    <a class="social-link" href="https://facebook.com" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24"><path d="M22 12a10 10 0 1 0-11.6 9.9v-7h-2.4v-2.9h2.4V9.7c0-2.4 1.4-3.8 3.6-3.8 1 0 2 .2 2 .2v2.3h-1.1c-1.1 0-1.4.7-1.4 1.4v1.7h2.5l-.4 2.9h-2.1v7A10 10 0 0 0 22 12z"/></svg>
    </a>

    <a class="social-link" href="https://wa.me" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 0 0-8.5 15.3L2 22l4.8-1.3A10 10 0 1 0 12 2z"/></svg>
    </a>

    <a class="social-link" href="https://t.me" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24"><path d="M21.9 4.6 2.4 10.6c-.8.3-.8 1.4 0 1.7l4.6 1.4 1.8 5.4c.2.7 1.1.9 1.6.4l2.6-2.6 5 3.7c.6.4 1.4.1 1.6-.6z"/></svg>
    </a>

    <a class="social-link" href="https://instagram.com" target="_blank" rel="noopener noreferrer">
      <svg viewBox="0 0 24 24"><path d="M12 2.2c3.2 0 3.6 0 4.8.1 1.2.1 2 .3 2.5.5.6.2 1 .5 1.5 1s.8.9 1 1.5c.2.5.4 1.3.5 2.5.1 1.2.1 1.6.1 4.8s0 3.6-.1 4.8c-.1 1.2-.3 2-.5 2.5-.2.6-.5 1-1 1.5s-.9.8-1.5 1c-.5.2-1.3.4-2.5.5-1.2.1-1.6.1-4.8.1s-3.6 0-4.8-.1c-1.2-.1-2-.3-2.5-.5-.6-.2-1-.5-1.5-1s-.8-.9-1-1.5c-.2-.5-.4-1.3-.5-2.5-.1-1.2-.1-1.6-.1-4.8s0-3.6.1-4.8c.1-1.2.3-2 .5-2.5.2-.6.5-1 1-1.5s.9-.8 1.5-1c.5-.2 1.3-.4 2.5-.5 1.2-.1 1.6-.1 4.8-.1z"/></svg>
    </a>
  </div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbxtKQvd0oc6FJUxhPw_wQPMpbi-6lgkOkO5YSvafh_lnVZht4z-hjMuRIjpspyQRX9O/exec";

async function search(){

  const q=qInput.value.trim();
  if(!q)return;
  loader.style.display="block";
  loadingText.style.display="block";
  resultsPanel.classList.add("show");

  const res=await fetch(`${API}?q=${encodeURIComponent(q)}`);
  const data=await res.json();
  tbody.innerHTML="";

  if(!data.length){
    empty.style.display="block";
    table.style.display="none";
  }else{
    data.forEach(r=>{
      tbody.innerHTML+=`<tr>
        <td>${r.ID}</td>
        <td>${r.name}</td>
        <td>${r.phone}</td>
        <td><span class="badge">${r.device||"-"}</span></td>
      </tr>`;
    });
    table.style.display="table";
    empty.style.display="none";
  }
  loader.style.display="none";
  loadingText.style.display="none";
}

function autoSearch(e){if(e.key==="Enter")search()}

const qInput=document.getElementById("q"),
loader=document.getElementById("loader"),
loadingText=document.getElementById("loading-text"),
resultsPanel=document.getElementById("results-panel"),
table=document.getElementById("table"),
tbody=table.querySelector("tbody"),
empty=document.getElementById("empty");

(function(){
  const footerEl = document.querySelector('.footer');
  const protectedEls = [resultsPanel, footerEl].filter(Boolean);

  
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('mousedown', e => { if(e.button === 2) e.preventDefault(); });

  
  protectedEls.forEach(el => {
    el.addEventListener('copy', e => e.preventDefault());
  });

  
  document.addEventListener('keydown', e => {
    const inside = protectedEls.some(el => el.contains(document.activeElement));
    if(inside && ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'c')){
      e.preventDefault();
    }
  });

  
  qInput.addEventListener('input', () => {
    if(qInput.value.trim() === '') {
      resultsPanel.classList.remove('show');
      tbody.innerHTML = '';
      table.style.display = 'none';
      empty.style.display = 'none';
      loader.style.display = 'none';
      loadingText.style.display = 'none';
    }
  });
})();

</script>

</body>
</html>
